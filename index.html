<!doctype html><html><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BT Customisation – Diagnostic</title>
<style>body{font-family:system-ui,sans-serif;margin:24px}pre{background:#f6f6f6;padding:12px;border-radius:8px;overflow:auto}</style>
</head><body>
<h1>Diagnostic</h1>
<div id="out">Testing…</div>
<script>
(async()=>{
  const out = document.getElementById('out');
  try {
    const res = await fetch('./data/templates.json',{cache:'no-store'});
    out.innerHTML = `<p>Fetch status: <b>${res.status}</b></p>`;
    const txt = await res.text();
    out.insertAdjacentHTML('beforeend', `<p>First 200 chars:</p><pre>${txt.slice(0,200).replace(/[<>&]/g,s=>({'<':'&lt;','>':'&gt;','&':'&amp;'}[s]))}${txt.length>200?'…':''}</pre>`);
    let data;
    try { data = JSON.parse(txt); } catch(e){ out.insertAdjacentHTML('beforeend', `<p><b>JSON parse error:</b> ${e.message}</p>`); return; }
    out.insertAdjacentHTML('beforeend', `<p>Records found: <b>${data.records?.length||0}</b></p>`);
    if (data.records?.length) {
      out.insertAdjacentHTML('beforeend', `<ul>${data.records.map(r=>`<li>${r.name} <small>(${r.SKU})</small></li>`).join('')}</ul>`);
    }
    out.insertAdjacentHTML('beforeend', `<p><a href="#/catalog">Go to catalog</a></p>`);
  } catch(err){
    out.innerHTML = `<p style="color:#b91c1c"><b>Error:</b> ${err?.message||err}</p>`;
  }
})();
</script>
</body></html>
